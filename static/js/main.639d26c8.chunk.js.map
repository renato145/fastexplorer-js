{"version":3,"sources":["Footer.js","GraphLayout.js","App.js","useSocket.js","index.js"],"names":["Footer","url","mail","style","width","className","color","paddingLeft","marginBottom","fontSize","href","target","Nav","Item","Link","clamp","value","min","max","enterLink","selection","attr","d","source","index","enterNode","r","simulation","clipPositions","append","text","name","updateLinks","x","y","updateNodes","updateGraph","selectAll","call","GraphLayout","nodes","links","ref","useRef","useMemo","forceSimulation","force","forceLink","distance","strength","forceManyBody","forceCollide","forceCenter","forceY","useEffect","select","setCenter","node","clientWidth","height","clientHeight","getSize","current","alpha","restart","on","window","addEventListener","console","log","svg","radius","data","join","enter","App","uri","useState","setData","socket","WebSocket","onopen","send","JSON","stringify","client","onmessage","event","msg","parse","onclose","useSocket","Container","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.639d26c8.chunk.js","sourcesContent":["import React from 'react';\nimport { Nav } from 'react-bootstrap';\n\nexport const Footer = ({ url }) => {\n  const mail = 'renato.hermoza@pucp.edu.pe';\n  const social = 'renato145';\n\n  return (\n    <footer style={{ width: '100%' }} className=\"mt-5\">\n      <p style={{ color: '#6c757d', paddingLeft: '1rem', marginBottom: '0rem', fontSize: '0.9rem' }}>\n        Made by: Renato Hermoza, check the{' '}\n        <a href={`https://github.com/renato145/${url}`} target=\"_black\">\n          source code\n        </a>\n        .\n      </p>\n      <hr className=\"mt-2\" />\n      <Nav className=\"justify-content-center\">\n        <Nav.Item>\n          <Nav.Link href={`mailto:${mail}`}>{mail}</Nav.Link>\n        </Nav.Item>\n        <Nav.Item>\n          <Nav.Link href={`https://twitter.com/${social}`} target=\"_black\">\n            Twitter\n          </Nav.Link>\n        </Nav.Item>\n        <Nav.Item>\n          <Nav.Link href={`https://github.com/${social}`} target=\"_black\">\n            GitHub\n          </Nav.Link>\n        </Nav.Item>\n        <Nav.Item>\n          <Nav.Link href={`https://${social}.github.io`} target=\"_black\">\n            Blog\n          </Nav.Link>\n        </Nav.Item>\n      </Nav>\n    </footer>\n  );\n};\n","import React, { useRef, useEffect, useMemo } from 'react';\nimport {\n  forceSimulation,\n  forceLink,\n  forceManyBody,\n  forceCenter,\n  select,\n  drag,\n  event,\n  scaleLinear,\n  extent,\n  forceCollide,\n  selectAll,\n  schemeCategory10,\n  forceX,\n  forceY,\n} from 'd3';\nimport './GraphLayout.css';\n\nconst clamp = (value, min, max) =>\n  value >= max ? max : value <= min ? min : value;\n\nconst getSize = (selection) => {\n  const node = selection.node();\n  return { width: node.clientWidth, height: node.clientHeight };\n};\n\nconst enterLink = (selection) => {\n  selection.attr(\n    'class',\n    (d) => `link node-${d.source.index} node-${d.target.index}`\n  );\n};\n\nconst enterNode = (selection, r, simulation, clipPositions) => {\n  selection.append('circle').attr('r', r);\n  // .attr('fill', (d) => schemeCategory10[d.k]);\n\n  selection\n    .attr('class', 'node')\n    .append('text')\n    .text((d) => d.name)\n    .attr('y', 35);\n  //     .call(\n  //       drag()\n  //         .on('start', (d) => dragStart(d, simulation))\n  //         .on('drag', (d) => dragOn(d, clipPositions))\n  //         .on('end', (d) => dragEnd(d, simulation))\n  //     )\n  //     .on('mouseenter', handleTooltipMouseEnter)\n  //     .on('mouseout', handleTooltipMouseOut);\n};\n\nconst getSvgRect = () =>\n  select('.svg-container svg').node().getBoundingClientRect();\n\nfunction handleTooltipMouseEnter(d) {\n  const { top, left } = getSvgRect();\n\n  select('.node-tooltip')\n    .attr('index', d.index)\n    .style('left', `${d.x + left}px`)\n    .style('top', `${d.y + top}px`)\n    .style('opacity', 1)\n    .select('text')\n    .text(d.name);\n\n  selectAll(`.node-${d.index}`).classed('active', true);\n}\n\nfunction handleTooltipMouseOut(d) {\n  select('.node-tooltip').style('opacity', 0);\n  selectAll(`.node-${d.index}`).classed('active', false);\n}\n\nconst dragStart = (d, simulation) => {\n  if (!event.active) simulation.alphaTarget(0.3).restart();\n  d.fx = d.x;\n  d.fy = d.y;\n};\n\nconst dragOn = (d, clipPositions) => {\n  const [x, y] = clipPositions(event.x, event.y);\n  d.fx = x;\n  d.fy = y;\n};\n\nconst dragEnd = (d, simulation) => {\n  if (!event.active) simulation.alphaTarget(0);\n  d.fx = null;\n  d.fy = null;\n};\n\nconst updateLinks = (selection) => {\n  selection\n    .attr('x1', (d) => d.source.x)\n    .attr('y1', (d) => d.source.y)\n    .attr('x2', (d) => d.target.x)\n    .attr('y2', (d) => d.target.y);\n};\n\nconst updateNodes = (selection) => {\n  selection.attr('transform', (d) => `translate(${d.x}, ${d.y})`);\n  //   const tooltip = select('.node-tooltip');\n  //   if (tooltip.node()) {\n  //     const index = +tooltip.attr('index');\n  //     const { top, left } = getSvgRect();\n  //     const { x, y } = selection.data().filter((d) => d.index === index)[0];\n  //     tooltip.style('left', `${x + left}px`).style('top', `${y + top}px`);\n  //   }\n};\n\nconst updateGraph = (selection) => {\n  selection.selectAll('.link').call(updateLinks);\n  selection.selectAll('.node').call(updateNodes);\n};\n\nexport const GraphLayout = ({ nodes, links }) => {\n  const ref = useRef();\n\n  const simulation = useMemo(() => {\n    return (\n      forceSimulation()\n        .force('links', forceLink().distance(0).strength(1))\n        .force('charge', forceManyBody().strength(-50))\n        .force('collide', forceCollide())\n        .force('center', forceCenter())\n        //   .force('x', forceX());\n        .force('y', forceY())\n    );\n  }, []);\n\n  useEffect(() => {\n    select('.svg-container')\n      .append('div')\n      .attr('class', 'node-tooltip')\n      .style('opacity', 0)\n      .append('text');\n  }, []);\n\n  useEffect(() => {\n    const setCenter = () => {\n      const svg = select(ref.current);\n      const { width, height} = getSize(svg);\n      simulation\n        .force('center')\n        .x(width / 2)\n        .y(height / 2);\n      simulation.alpha(0.5).restart();\n    };\n\n    simulation.on('tick', () => select(ref.current).call(updateGraph));\n    window.addEventListener('resize', () => setCenter());\n    setCenter();\n    console.log('graph: update center');\n  }, [simulation]);\n\n  useEffect(() => {\n    const svg = select(ref.current);\n    const r = 15;\n    // const degreeExtent = extent(nodes.map((d) => d.degree));\n    // const scaleDegreeRadius = scaleLinear().domain(degreeExtent).range([5, 20]);\n\n    simulation.nodes(nodes);\n    simulation.force('links').links(links);\n    simulation.force('collide').radius(r);\n\n    // Links\n    svg\n      .selectAll('.link')\n      .data(links, (d) => d.index)\n      .join((enter) => enter.append('line').call(enterLink))\n      .call(updateLinks);\n\n    // Nodes\n    const clipPositions = (x, y) => [\n      clamp(x, 0, +svg.attr('width')),\n      clamp(y, 0, +svg.attr('height')),\n    ];\n\n    svg\n      .selectAll('.node')\n      .data(nodes, (d) => d.index)\n      .join((enter) =>\n        enter.append('g').call(enterNode, r, simulation, clipPositions)\n      )\n      .call(updateNodes);\n\n    simulation.alpha(0.5).restart();\n    console.log('update data');\n  }, [simulation, nodes, links]);\n\n  return (\n    <div className=\"svg-container\">\n      <svg ref={ref} />\n    </div>\n  );\n};\n","import React from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Footer } from './Footer';\nimport { useSocket } from './useSocket';\nimport { GraphLayout } from './GraphLayout';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport './App.css';\n\nconst uri = 'ws://localhost:8000/ws';\n\n// TODO\n// https://observablehq.com/@d3/collapsible-tree?collection=@d3/d3-hierarchy -> instead of force sim\n\nfunction App() {\n  const { data } = useSocket({ uri });\n  console.log(data);\n\n  return (\n    <Container className=\"app-container\">\n      <header>\n        <h1 className=\"mt-4 mb-4\">Fast Explorer</h1>\n      </header>\n\n      <main>\n        <p>Work in progress...</p>\n        {data && (\n          <GraphLayout\n            nodes={data.nodes}\n            links={data.links}\n          />\n        )}\n      </main>\n\n      <Footer url=\"fastexplorer-js\" />\n    </Container>\n  );\n}\n\nexport default App;\n","import { useMemo, useState } from 'react';\n\n// TODO:\n// Reconnect socket\n// Use redux to manage data\n\nexport const useSocket = ({ uri }) => {\n  const [data, setData] = useState();\n  const socket = useMemo(() => {\n    const socket = new WebSocket(uri);\n\n    socket.onopen = () => {\n      console.log('socket connected.');\n      socket.send(JSON.stringify({ client: 'web_client' }));\n    };\n\n    socket.onmessage = (event) => {\n      const msg = JSON.parse(event.data);\n      console.log(`socket server event: ${msg.event}`);\n      switch (msg.event) {\n        case 'representation_data':\n          setData(JSON.parse(msg.msg));\n          break;\n        case 'close':\n          // closeMessage = ` (${msg.msg}).`;\n          break;\n        default:\n          console.log(`Invalid event: ${msg.event}.`);\n      }\n    };\n\n    socket.onclose = () => {\n      console.log('socket closed.');\n    };\n\n    return socket;\n  }, [uri]);\n\n  return { data, socket };\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\n// ReactDOM.render(\n//   <React.StrictMode>\n//     <App />\n//   </React.StrictMode>,\n//   document.getElementById('root')\n// );\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}